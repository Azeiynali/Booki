<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>خانه - مدرسه علم و فرهنگ</title>

        <link rel="stylesheet" href="../static/css/root.css" />
        <link rel="stylesheet" href="../static/css/home.css" />
        <link rel="stylesheet" href="../static/library/Vuetify.css" />
    </head>

    <body>
        <div id="app">
            <navbar
                @comment="open_comd"
                @image="open_immd"
                active_item="home"
            ></navbar>
            <site-header
                items='{
                    "all": [
                        {
                            "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/2022/12/2cb55042e960ce1880df1aa5dd833099_6.jpg-1.webp",
                            "user_img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                            "user_href": "#",
                            "username": "Ali"
                        },
                        {
                            "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/2022/12/2cb55042e960ce1880df1aa5dd833099_6.jpg-1.webp",
                            "user_img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                            "user_href": "#",
                            "username": "Ali"
                        },
                        {
                            "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/2022/12/2cb55042e960ce1880df1aa5dd833099_6.jpg-1.webp",
                            "user_img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                            "user_href": "#",
                            "username": "Ali"
                        },
                        {
                            "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/2022/12/2cb55042e960ce1880df1aa5dd833099_6.jpg-1.webp",
                            "user_img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                            "user_href": "#",
                            "username": "Ali"
                        },
                        {
                            "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/2022/12/2cb55042e960ce1880df1aa5dd833099_6.jpg-1.webp",
                            "user_img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                            "user_href": "#",
                            "username": "Ali"
                        },
                        {
                            "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/2022/12/2cb55042e960ce1880df1aa5dd833099_6.jpg-1.webp",
                            "user_img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                            "user_href": "#",
                            "username": "Ali"
                        },
                        {
                            "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/2022/12/2cb55042e960ce1880df1aa5dd833099_6.jpg-1.webp",
                            "user_img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                            "user_href": "#",
                            "username": "Ali"
                        },
                        {
                            "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/2022/12/2cb55042e960ce1880df1aa5dd833099_6.jpg-1.webp",
                            "user_img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                            "user_href": "#",
                            "username": "Ali"
                        }
                    ]
                }
                '
            >
            </site-header>
            <comment-model ref="comd"></comment-model>
            <image-model ref="immd"></image-model>
            <div class="container">
                <div class="posts">
                    <post
                        content="<img class='img' src='https://cdn.dribbble.com/userupload/9583660/file/original-e27155a0df451cd4cb30db64a51883a8.jpg?resize=752x'><p>اینیک تصویر است که یک تصویر است و.... چرا 1 2 3 و..... هم اینکه من <br /> ااا</p>"
                        user_detail='{
                        "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                        "username": "علی",
                        "ckeck": true,
                        "date": "2 ماه پیش",
                        "href":"#",
                        "post_href": "#"
                    }'
                        classes="img-container post"
                    ></post>
                    <post
                        content="<h1>welcome to this blog</h1>"
                        user_detail='{
                        "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                        "username": "علی",
                        "ckeck": true,
                        "date": "2 ماه پیش",
                        "href":"#",
                        "post_href": "#"
                    }'
                    ></post>
                    <comment
                        content="این یک نظر کوچک است"
                        user_detail='{
                        "img": "https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg",
                        "username": "علی",
                        "ckeck": true,
                        "date": "2 ماه پیش",
                        "href":"#",
                        "post_href": "#"
                    }'
                    ></comment>
                    <avatar
                        old_avatar="https://cdn-icons-png.flaticon.com/512/1211/1211015.png"
                        new_avatar="https://cdn-icons-png.flaticon.com/512/1999/1999625.png"
                        username="علی"
                        date="3 ماه پیش"
                        href="#"
                    ></avatar>
                </div>
                <div class="left-items">
                    <div dir="rtl" class="top">
                        <p>کاربران برتر</p>
                        <user
                            username="علی"
                            score="120"
                            href="#"
                            img="https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg"
                        ></user>
                    </div>
                    <div dir="rtl" class="top">
                        <p>محل شما</p>
                        <user
                            username="علی"
                            score="120"
                            href="#"
                            img="https://wordpress.iqonic.design/product/wp/socialv/wp-content/uploads/avatars/18/1656590512-bpfull.jpg"
                        ></user>
                    </div>
                </div>
            </div>
        </div>
        <!-- script -->

        <script src="https://cdn.ckeditor.com/ckeditor5/39.0.1/classic/ckeditor.js"></script>
        <script src="../static/library/vue.js"></script>
        <script src="../static/library/Vuetify.js"></script>
        <script
            src="https://kit.fontawesome.com/7552b865b0.js"
            crossorigin="anonymous"
        ></script>
        <!-- FontAwesome -->
        {% raw  %}
        <script>
            Vue.component("navbar-item", {
                props: {
                    text: {},
                    href: {},
                    active: {
                        default: false,
                    },
                },
                template: `
                              <a ref="a" class="navbar-item" v-html="text" :href="href"></a>
                              `,
            });

            Vue.component("navbar", {
                props: {
                    active_item: {
                        default: false,
                    },
                    message_count: {
                        default: 0,
                    },
                },
                data() {
                    return {};
                },
                methods: {
                    plus() {
                        this.$refs.button.classList.toggle("is-active");
                    },
                    comment() {
                        this.$emit("comment");
                    },
                    image() {
                        this.$emit("image");
                    },
                },
                template: `
                            <nav class="nav">
                                  <img class="logo" src="https://cdn-icons-png.flaticon.com/512/4096/4096358.png" />
                                  <div class="nav-items">
                                    <navbar-item href="#" ref="profile" text="پروفایل" :class="{ active: active_item === 'profile' }"></navbar-item>
                                    <navbar-item href="#" ref="dasboard" text="جستجو" :class="{ active: active_item === 'search' }"></navbar-item>
                                    <navbar-item href="#" ref="chatroom" text="گفتگو" :class="{ active: active_item === 'chat' }"></navbar-item>
                                    <navbar-item href="#" ref="chatroom" text="خانه" :class="{ active: active_item === 'home' }"></navbar-item>
                                  </div>
                                  <div class="profile-nav">
                                      <i class="fa-solid fa-envelope"><div v-if="message_count" class="note_num">3</div></i>
                                      <img class="profile-pic" src="https://cdn-icons-png.flaticon.com/512/4096/4096358.png" />
                                  </div>
                                  <div v-if="active_item == 'home'" dir="rtl" ref="button" class="plus-button">
                                    <a @click="plus" href="#" class="button">
                                        <svg class="arrow arrow-left" viewBox="0 0 448 448">
                                            <path
                                                d="M272 176H32c-18 0-32 14-32 32v32c0 18 14 32 32 32h144v144c0 18 14 32 32 32h32c18 0 32-14 32-32V176z"
                                            />
                                        </svg>
                                        <svg class="arrow arrow-right" viewBox="0 0 448 448">
                                            <path
                                                d="M176 272h240c18 0 32-14 32-32v-32c0-18-14-32-32-32H272V32c0-18-14-32-32-32h-32c-18 0-32 14-32 32v240z"
                                            />
                                        </svg>
                                    </a>
                                    <div class="menu">
                                        <a href="#">مقاله</a><br />
                                        <a @click="image" href="#">عکس</a><br />
                                        <a @click="comment" href="#">نظر</a><br />
                                    </div>
                                </div>
                            </nav>`,
            });

            Vue.component("site-header", {
                props: {
                    items: {
                        type: String,
                        default: "{}",
                    },
                },
                data() {
                    return {
                        items_dict: JSON.parse(this.items),
                    };
                },
                template: `
                            <header ref="root" class="header">
                                <a :href="item.user_href" v-for="item in items_dict.all" class="item">
                                    <img
                                        :src="item.img"
                                        alt="*"
                                    />
                                    <div :style="'background: url(' + item.user_img + ');'" class="user"></div>
                                    <p>{{ item.username }}</p>
                                </a>
                            </header>
                            `,
            });

            Vue.component("post", {
                props: {
                    user_detail: {
                        default: "{}",
                    },
                    content: {
                        default: "",
                    },
                    comments: {
                        default: 0,
                    },
                    is_comment: {
                        default: "",
                    },
                    likes: {
                        default: 0,
                    },
                    classes: { default: "post" },
                },
                data() {
                    return {
                        us_content: unescape(this.content),
                        user_details: JSON.parse(this.user_detail),
                        icon: "regular",
                    };
                },
                methods: {
                    like() {
                        if (
                            this.$refs.like.getAttribute("class") ==
                            "like liked"
                        ) {
                            this.icon = "regular";
                            this.likes--;
                        } else {
                            this.likes++;
                            this.icon = "solid";
                        }
                        this.$refs.like.classList.toggle("liked");
                    },
                    exclamation(ev) {
                        this.$refs.message.style.opacity = "1";
                        this.$refs.message.style.left = "-19px";
                        this.$refs.message.innerText = "گزارش داده شد!";
                        setTimeout(() => {
                            this.$refs.message.style = "";
                            this.$refs.message.style.left = "-19px";
                        }, 2000);
                    },
                },
                template: `
                    <div :class="classes">
                        <div dir="rtl" class="user">
                            <a :href="user_details.href">
                                <img :src="user_details.img" />
                            </a>
                            <a :href="user_details.href">
                                <div>
                                    <p>
                                        {{ user_details.username }}

                                    </p>
                                    <small>{{ user_details.date }}</small>
                                </div>
                            </a>
                            <i class="menu fa-solid fa-exclamation" @click="exclamation"></i>
                            <div ref="message" class="details">گزارش دادن</div>
                        </div>
                        <div v-html="us_content" dir="rtl" class="content"></div>
                        <div dir="rtl" class="bottom">
                            <div @click="like" ref="like" class="like">
                                <i :class='"fa-" + icon + " fa-heart"'></i>
                                <small>{{ likes }}</small>
                            </div>
                            <a :href="user_details.post_href" :class="'like ' + is_comment">
                                <i class="fa-solid fa-message"></i>
                                <small>{{ comments }}</small>
                            </a>
                        </div>
                    </div>
                `,
            });

            Vue.component("comment", {
                props: {
                    user_detail: {
                        default: "{}",
                    },
                    content: {
                        default: "",
                    },
                },
                data() {
                    return {
                        us_content: unescape(this.content),
                        user_details: JSON.parse(this.user_detail),
                        icon: "regular",
                    };
                },
                methods: {
                    like() {
                        if (
                            this.$refs.like.getAttribute("class") ==
                            "like liked"
                        ) {
                            this.icon = "regular";
                            this.likes--;
                        } else {
                            this.likes++;
                            this.icon = "solid";
                        }
                        this.$refs.like.classList.toggle("liked");
                    },
                    exclamation(ev) {
                        this.$refs.message.style.opacity = "1";
                        this.$refs.message.style.left = "-19px";
                        this.$refs.message.innerText = "گزارش داده شد!";
                        setTimeout(() => {
                            this.$refs.message.style = "";
                            this.$refs.message.style.left = "-19px";
                        }, 2000);
                    },
                },
                template: `
                    <div class="post">
                        <div style="transform: scale(.7);margin-left: 23%;" dir="rtl" class="user">
                            <a :href="user_details.href">
                                <img :src="user_details.img" />
                            </a>
                            <a :href="user_details.href">
                                <div>
                                    <p>
                                        {{ user_details.username }}

                                    </p>
                                    <small>{{ user_details.date }}</small>
                                </div>
                            </a>
                        </div>
                        <div dir="rtl" class="content">{{ us_content }}</div>

                    </div>
                `,
            });

            Vue.component("avatar", {
                props: {
                    old_avatar: {},
                    new_avatar: {},
                    username: {},
                    date: {},
                    href: {},
                    likes: {
                        default: 0,
                    },
                },
                data() {
                    return {
                        icon: "regular",
                    };
                },
                methods: {
                    like() {
                        if (
                            this.$refs.like.getAttribute("class") ==
                            "like liked"
                        ) {
                            this.icon = "regular";
                            this.likes--;
                        } else {
                            this.likes++;
                            this.icon = "solid";
                        }
                        this.$refs.like.classList.toggle("liked");
                    },
                },
                template: `
                    <div class="post avatar-changed">
                        <div dir="rtl" class="user">
                            <a :href="href">
                                <img :src="new_avatar" />
                            </a>
                            <a :href="href">
                                <div>
                                    <p>
                                        {{ username }}

                                    </p>
                                    <small>{{ date }}</small>
                                </div>
                            </a>
                        </div>
                        <p>{{ username }} آواتارش را تغییر داد</p>
                        <div class="avatar-changed">
                            <img :src="new_avatar" alt="new_avatar">
                            <i class="fa-solid fa-arrow-left"></i>
                            <img :src="old_avatar" alt="old_avatar" />
                        </div>
                        <div dir="rtl" class="bottom">
                            <div @click="like" ref="like" class="like">
                                <i :class='"fa-" + icon + " fa-heart"'></i>
                                <small>{{ likes }}</small>
                            </div>
                        </div>
                    </div>
                    `,
            });

            Vue.component("comment-model", {
                data() {
                    return {
                        comment: "",
                        chars: 300,
                        error: "",
                        max_chars: 300,
                    };
                },
                methods: {
                    type() {
                        this.chars =
                            this.max_chars - this.$refs.text.value.length;
                        if (this.chars <= 0) {
                            this.error = true;
                            this.$refs.error.classList.add("e");
                            this.$refs.button.classList.add("disable");
                        } else {
                            this.$refs.error.classList.remove("e");
                            this.$refs.button.classList.remove("disable");
                            this.error = false;
                        }
                    },
                    open() {
                        this.$refs.root.style.display = "flex";
                    },
                    close() {
                        this.$refs.root.style.display = "none";
                    },
                    submit() {
                        if (!this.error) {
                            setTimeout(() => {
                                this.$refs.root.style.display = "none";
                            }, 1000);
                            this.comment = "";
                        }
                    },
                },
                template: `
                        <div style="display: none"  ref="root" class="comment-model-container">
                            <div class="model">
                                <textarea @keyup="type" ref="text" v-bind="comment" cols="40" rows="7"></textarea>
                                <p ref="error" class="error">{{ chars }}</p>
                                <button @click="close" class="close">بستن</button>
                                <button @click="submit" ref="button">انتشار</button>
                            </div>
                        </div>`,
            });

            Vue.component("image-model", {
                data() {
                    return {
                        comment: "",
                        chars: 2000,
                        image: null,
                        max_chars: 2000,
                        error: "",
                    };
                },
                methods: {
                    type() {
                        this.chars =
                            this.max_chars - this.$refs.text.value.length;
                        if (this.chars <= 0) {
                            this.$refs.error.classList.add("e");
                            this.$refs.button.classList.add("disable");
                            this.error = true;
                        } else {
                            this.$refs.error.classList.remove("e");
                            this.$refs.button.classList.remove("disable");
                            this.error = false;
                        }
                    },
                    open() {
                        this.$refs.root.style.display = "flex";
                    },
                    close() {
                        this.$refs.root.style.display = "none";
                    },
                    submit() {
                        const formData = new FormData();
                        formData.append("file", this.image);

                        if (!this.error && this.image) {
                            // axios.post("آدرس-سرور", formData, {
                            //   headers: {
                            //     "Token": "FFFFFFFF13880",
                            //   },
                            // });
                            setTimeout(() => {
                                this.$refs.root.style.display = "none";
                            }, 1000);
                            this.comment = "";
                        }
                    },
                },
                template: `
                        <div style="display: none" ref="root" class="image-model-container">
                            <div class="model">

                                <v-file-input
                                    label="image"
                                    truncate-length="32"
                                    v-model="image"
                                    ref="image"
                                ></v-file-input>

                                <textarea @keyup="type" ref="text" v-bind="comment" cols="40" rows="7"></textarea>
                                <p ref="error" class="error">{{ chars }}</p>
                                <button @click="close" class="close">بستن</button>
                                <button @click="submit" ref="button">انتشار</button>
                            </div>
                        </div>`,
            });

            Vue.component("user", {
                props: ["img", "score", "href", "username"],
                template: `
                    <div style="transform: scale(.7);margin-left: 23%;" dir="rtl" class="user">
                            <a :href="href">
                                <img :src="img" />
                            </a>
                            <a :href="href">
                                <div>
                                    <p>
                                        {{ username }}

                                    </p>
                                    <small>🪙{{ score }}</small>
                                </div>
                            </a>
                        </div>
                    `,
            });

            new Vue({
                el: "#app",
                methods: {
                    open_comd() {
                        this.$refs.comd.open();
                    },
                    open_immd() {
                        this.$refs.immd.open();
                    },
                },
            });
        </script>
        {% endraw %}
    </body>
</html>
